---
description: "Security review rules for sensitive code"
globs: ["**/auth/**", "**/login/**", "**/security/**", "**/crypto/**", "**/password*", "**/token*", "**/session*", "**/api/**"]
---

# Security Rules

When working with security-sensitive code:

## OWASP Top 10 Awareness

- **Injection** - Validate and sanitize all inputs
- **Broken Auth** - Use established auth libraries
- **Sensitive Data** - Encrypt at rest and in transit
- **XXE** - Disable external entities in XML
- **Access Control** - Validate permissions on every request
- **Misconfiguration** - Follow secure defaults
- **XSS** - Escape output, use CSP
- **Deserialization** - Avoid deserializing untrusted data
- **Components** - Keep dependencies updated
- **Logging** - Log security events, protect logs

## Security Checklist

- [ ] No secrets in code or logs
- [ ] Input validation on all boundaries
- [ ] Output encoding for context
- [ ] Authentication on protected routes
- [ ] Authorization checked per-resource
- [ ] Sensitive data encrypted

## Reference

For security review methodology, see `.doyaken/prompts/library/review-security.md`
